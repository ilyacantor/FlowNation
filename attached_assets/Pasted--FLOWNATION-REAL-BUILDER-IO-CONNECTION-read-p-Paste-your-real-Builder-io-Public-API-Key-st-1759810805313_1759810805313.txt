# FLOWNATION â€” REAL BUILDER.IO CONNECTION
read -p "ðŸ‘‰ Paste your real Builder.io Public API Key (starts with 'public-'): " BUILDER_KEY

echo "ðŸ”— Connecting FlowNation app to Builder.io..."
# Ensure dependencies and folder structure exist
npm install @builder.io/react react-router-dom lucide-react --silent
mkdir -p src/pages builder src/components

# Write environment variable directly
echo "VITE_BUILDER_API_KEY=$BUILDER_KEY" > .env

# Create Landing page that actually pulls from Builder
cat <<'EOF' > src/pages/Landing.jsx
import React, { useEffect, useState } from "react";
import { builder, BuilderComponent } from "@builder.io/react";

builder.init(import.meta.env.VITE_BUILDER_API_KEY);

export default function Landing() {
  const [content, setContent] = useState(null);

  useEffect(() => {
    builder
      .get("page", { url: window.location.pathname })
      .promise()
      .then(setContent);
  }, []);

  return (
    <div className="min-h-screen bg-black text-white">
      <BuilderComponent model="page" content={content} />
    </div>
  );
}
EOF

# Basic routing and component registration
cat <<'EOF' > src/App.jsx
import React from "react";
import { BrowserRouter as Router, Routes, Route } from "react-router-dom";
import Landing from "./pages/Landing";
import "../builder/registerComponents";

export default function App() {
  return (
    <Router>
      <Routes>
        <Route path="/*" element={<Landing />} />
      </Routes>
    </Router>
  );
}
EOF

cat <<'EOF' > builder/registerComponents.js
import { Builder } from "@builder.io/react";
import React from "react";

export const Placeholder = ({ text }) => (
  <div style={{
    padding: "40px",
    background: "#0b0b0d",
    border: "1px solid #333",
    color: "#fff",
    borderRadius: "8px",
    textAlign: "center"
  }}>
    {text || "FlowNation editable section"}
  </div>
);

Builder.registerComponent(Placeholder, {
  name: "Placeholder",
  inputs: [{ name: "text", type: "string", defaultValue: "Editable area" }],
});
EOF

echo "âœ… Connected to Builder.io with your real key: $BUILDER_KEY"
echo "âž¡ Run the project now â€” it will pull live content from your Builder space."
